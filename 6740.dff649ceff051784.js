"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6740],{6740:(j,C,d)=>{d.r(C),d.d(C,{MapPageModule:()=>b});var f=d(2200),k=d(9417),c=d(8974),s=d(3664),v=d(5855),y=d(5005),u=d(467),L=d(5551),z=d(7144),M=d(2615);let A=(()=>{var a;class m{constructor(){}loadGoogleMaps(){const e=window,t=e.google;return t&&t.maps?Promise.resolve(t.maps):new Promise((o,l)=>{const n=document.createElement("script");n.src="https://maps.googleapis.com/maps/api/js?key="+z.c.googleMapsAPIKey,n.async=!0,n.defer=!0,document.body.appendChild(n),n.onload=()=>{const r=e.google;r&&r.maps?o(r.maps):l("Google Map SDK is not Available")}})}}return(a=m).\u0275fac=function(e){return new(e||a)},a.\u0275prov=M.jDH({token:a,factory:a.\u0275fac,providedIn:"root"}),m})();var S=d(9876);const N=["map"];let P=(()=>{var a;class m{constructor(e,t,o,l,n){this.router=e,this.gmaps=t,this.renderer=o,this.actionSheetCtrl=l,this.common=n,this.addStateBoundaries=!1,this.stateFilter="all",this.mode="brand",this.changedAt=null,this.center={lat:39.8283,lng:-98.5795},this.markers=[],this.mapZoom=4,this.mapTypeId="roadmap"}ngOnInit(){console.log("In Map Page"),this.stateCoords=this.loadStateCoords(),this.loadMap()}ngOnChanges(){console.log("changedAt",this.changedAt),this.loadMap()}loadMap(){var e=this;return(0,u.A)(function*(){try{let t=yield e.gmaps.loadGoogleMaps();e.googleMaps=t;const o=e.mapElementRef.nativeElement;if(null!=e.loationsToAdd&&1==e.loationsToAdd.length)e.mapZoom=20,e.center={lat:+e.loationsToAdd[0].lat,lng:+e.loationsToAdd[0].lng},e.mapTypeId="satellite";else if("label"==e.mode)e.mapZoom=5.2,e.center=e.center,e.mapTypeId="roadmap";else if("all"!=e.stateFilter.toLowerCase()){if(1==e.stateFilter.split(",").length){let r=e.stateCoords.find(i=>i.stateName==e.stateFilter);null!=r&&(e.center=r.stateCenter,e.mapZoom=r.zoomLevel,e.mapTypeId="roadmap")}}else e.center=e.center,e.mapZoom=4,e.mapTypeId="roadmap";const l=new t.LatLng(e.center.lat,e.center.lng);if(console.log("location",l),e.map=new t.Map(o,{center:l,zoom:e.mapZoom,mapTypeId:e.mapTypeId}),e.renderer.addClass(o,"visible"),e.loadMarkers(),e.addStateBoundaries&&"all"!=e.stateFilter.toLowerCase()){let n=e.stateFilter.split(",");for(let r=0;r<n.length;r++){let i=n[r],g=e.stateCoords.find(h=>h.stateName==i).polygonCoordinates;e.drawPolygon(g)}}}catch(t){console.log(t)}})()}drawPolygon(e){new this.googleMaps.Polygon({paths:e,strokeColor:"#FF0000",strokeOpacity:.8,strokeWeight:2,fillColor:"#FF0000",fillOpacity:.35}).setMap(this.map)}loadMarkers(){if(this.markers=[],null!=this.loationsToAdd&&null!=this.loationsToAdd){for(let e=0;e<this.loationsToAdd.length;e++)if(e<1e4){let t=this.loationsToAdd[e],o=null;if("label"==this.mode){let l=this.stateCoords.find(n=>n.stateName==t.state);null!=l&&(o=l.stateCenter)}else o={lat:+t.lat,lng:+t.lng};"brand"==this.mode?this.addMarkerLogos(o,"chevron"==t.brand.toLowerCase(),"texaco"==t.brand.toLowerCase(),"1"==t.extramile,t.name,t.address+", "+t.city+", "+t.state+" "+t.zipcode):"kpi"==this.mode?this.addMarkerKPIs(o,t.color,t.isPercent,t.kpi,t.name,t.address+", "+t.city+", "+t.state+" "+t.zipcode):"label"==this.mode&&null!=o&&this.addMarkerLabels(o,t.label,t.state)}}else{const e={lat:37.7979,lng:-121.9222};console.log("locVal",e),this.addMarker(e)}}onMapClick(){this.mapClickListener=this.googleMaps.event.addListener(this.map,"click",e=>{console.log(e.latLng.toJSON()),this.addMarker(e.latLng)})}addMarker(e){let t=this.googleMaps;const o={url:"assets/icon/map-pin.png",scaledSize:new t.Size(50,50)},l=new t.Marker({position:e,map:this.map,icon:o,animation:t.Animation.DROP});this.markers.push(l),this.markerClickListener=this.googleMaps.event.addListener(l,"click",()=>{console.log("markerclick",l),this.checkAndRemoveMarker(l),console.log("markers: ",this.markers)})}addMarkerLogos(e,t=!1,o=!1,l=!1,n="",r=""){l?t?this.addMarkerLogo(e,"chevron-extramile",n,r):o&&this.addMarkerLogo(e,"texaco-extramile",n,r):t?this.addMarkerLogo(e,"chevron",n,r):o&&this.addMarkerLogo(e,"texaco",n,r)}addMarkerLogo(e,t,o="",l=""){let n=this.googleMaps;const r={url:"assets/icon/map-"+t+".png",scaledSize:new n.Size(60,60)},i=new n.Marker({position:e,map:this.map,icon:r});this.markers.push(i),this.markerClickListener=this.googleMaps.event.addListener(i,"click",()=>{console.log("markerclick",i),this.showLocationInfo(i,o,l),console.log("markers: ",this.markers)})}addMarkerKPIs(e,t,o,l,n="",r=""){this.addMarkerKPI(e,t,o,l,n,r)}addMarkerKPI(e,t="question",o,l,n="",r=""){let i=this.googleMaps;const g={url:"assets/icon/"+t+"Small.png",scaledSize:new i.Size(30,30)},h=new i.Marker({position:e,map:this.map,icon:g});this.markers.push(h),this.markerClickListener=this.googleMaps.event.addListener(h,"click",()=>{console.log("markerclick",h),this.showLocationInfo(h,n,r,o,l),console.log("markers: ",this.markers)})}addMarkerLabels(e,t,o){this.addMarkerLabel(e,t,o)}addMarkerLabel(e,t,o){let l=this.googleMaps;const n={url:"assets/icon/frame.png",scaledSize:new l.Size(80,80)},i=new l.Marker({position:e,map:this.map,icon:n,label:{text:t,color:"black",fontSize:"16px",fontWeight:"bold"}});this.markers.push(i),this.markerClickListener=this.googleMaps.event.addListener(i,"click",()=>{console.log("markerclick",i),this.showLocationInfo(i,o+" ( "+t+" )","",!1,null),console.log("markers: ",this.markers)})}showLocationInfo(e,t="",o="",l=!1,n=0){const r=this.markers.findIndex(g=>g.position.lat()==e.position.lat()&&g.position.lng()==e.position.lng());console.log("is marker already: ",r);let i=t;null!=o&&""!=o&&(i+=" ( "+o+" )"),"kpi"==this.mode&&(i+=l?" - ( "+n.toFixed(2)+"% )":" - ( "+n.toFixed(2)+" )"),this.common.presentToastMiddle(i)}checkAndRemoveMarker(e){const t=this.markers.findIndex(o=>o.position.lat()==e.position.lat()&&o.position.lng()==e.position.lng());if(console.log("is marker already: ",t),t>=0)return this.markers[t].setMap(null),void this.markers.splice(t,1)}presentActionSheet(){var e=this;return(0,u.A)(function*(){yield(yield e.actionSheetCtrl.create({header:"Added Marker",subHeader:"",buttons:[{text:"Remove",role:"destructive",data:{action:"delete"}},{text:"Save",data:{action:"share"}},{text:"Cancel",role:"cancel",data:{action:"cancel"}}]})).present()})()}ngOnDestroy(){this.mapClickListener&&this.googleMaps.event.removeListener(this.mapClickListener),this.markerClickListener&&this.googleMaps.event.removeListener(this.markerClickListener)}loadStateCoords(){return[{stateName:"CA",stateCenter:{lat:36.7783,lng:-119.4179},polygonCoordinates:[],zoomLevel:6.5},{stateName:"AZ",stateCenter:{lat:33.4525,lng:-112.0689},polygonCoordinates:[],zoomLevel:7.5},{stateName:"FL",stateCenter:{lat:28.681389,lng:-82.46},polygonCoordinates:[],zoomLevel:7.5},{stateName:"TX",stateCenter:{lat:31.391533,lng:-99.17065},polygonCoordinates:[],zoomLevel:7.5},{stateName:"NV",stateCenter:{lat:38.8026,lng:-116.4194},polygonCoordinates:[],zoomLevel:7.5},{stateName:"GA",stateCenter:{lat:32.1574,lng:-82.9071},polygonCoordinates:[],zoomLevel:7.5},{stateName:"UT",stateCenter:{lat:40.7607,lng:-111.8939},polygonCoordinates:[],zoomLevel:7.5},{stateName:"AL",stateCenter:{lat:32.3182,lng:-86.9023},polygonCoordinates:[],zoomLevel:7.5},{stateName:"LA",stateCenter:{lat:30.5191,lng:-91.5209},polygonCoordinates:[],zoomLevel:7.5},{stateName:"OR",stateCenter:{lat:42.0167,lng:-93.1635},polygonCoordinates:[],zoomLevel:7.5},{stateName:"WA",stateCenter:{lat:47.7511,lng:-120.7401},polygonCoordinates:[],zoomLevel:7.5},{stateName:"ID",stateCenter:{lat:44.0682,lng:-114.742},polygonCoordinates:[],zoomLevel:7.5},{stateName:"MS",stateCenter:{lat:33.4577,lng:-88.7942},polygonCoordinates:[],zoomLevel:7.5},{stateName:"HI",stateCenter:{lat:19.8987,lng:-155.6659},polygonCoordinates:[],zoomLevel:7.5},{stateName:"NM",stateCenter:{lat:34.9727,lng:-105.0324},polygonCoordinates:[],zoomLevel:7.5},{stateName:"AK",stateCenter:{lat:63.5888,lng:-154.4931},polygonCoordinates:[],zoomLevel:7.5},{stateName:"SC",stateCenter:{lat:33.8361,lng:-81.1637},polygonCoordinates:[],zoomLevel:7.5},{stateName:"TN",stateCenter:{lat:35.5175,lng:-86.5804},polygonCoordinates:[],zoomLevel:7.5},{stateName:"WY",stateCenter:{lat:43.076,lng:-107.2903},polygonCoordinates:[],zoomLevel:7.5},{stateName:"CO",stateCenter:{lat:37.7531,lng:-106.1086},polygonCoordinates:[],zoomLevel:7.5},{stateName:"MT",stateCenter:{lat:46.8797,lng:-110.3626},polygonCoordinates:[],zoomLevel:7.5},{stateName:"NC",stateCenter:{lat:35.7596,lng:-79.0193},polygonCoordinates:[],zoomLevel:7.5},{stateName:"AR",stateCenter:{lat:35.201,lng:-91.8318},polygonCoordinates:[],zoomLevel:7.5}]}}return(a=m).\u0275fac=function(e){return new(e||a)(s.rXU(L.Ix),s.rXU(A),s.rXU(s.sFG),s.rXU(c.GD),s.rXU(S.h))},a.\u0275cmp=s.VBU({type:a,selectors:[["google-map"]],viewQuery:function(e,t){if(1&e&&s.GBs(N,7),2&e){let o;s.mGM(o=s.lsd())&&(t.mapElementRef=o.first)}},inputs:{loationsToAdd:"loationsToAdd",addStateBoundaries:"addStateBoundaries",stateFilter:"stateFilter",mode:"mode",changedAt:"changedAt"},standalone:!1,features:[s.OA$],decls:2,vars:0,consts:[["map",""],[1,"map"]],template:function(e,t){1&e&&s.nrm(0,"div",1,0)},styles:[".map[_ngcontent-%COMP%]{position:absolute;height:100%;width:100%;background-color:transparent;opacity:0;transition:opacity .15s ease-in}.map.visible[_ngcontent-%COMP%]{opacity:1}"]}),m})();var G=d(6409);let I=(()=>{var a;class m{ngOnInit(){}ngOnDestroy(){}}return(a=m).\u0275fac=function(e){return new(e||a)},a.\u0275cmp=s.VBU({type:a,selectors:[["app-map"]],standalone:!1,decls:8,vars:1,consts:[[3,"PageTitle"],["contentId","main-content","type","overlay"],[1,"pageClass"]],template:function(e,t){1&e&&(s.j41(0,"ion-header"),s.nrm(1,"app-header",0),s.k0s(),s.j41(2,"ion-menu",1),s.nrm(3,"app-admin-menu"),s.k0s(),s.j41(4,"ion-content",2),s.nrm(5,"google-map"),s.k0s(),s.j41(6,"ion-footer"),s.nrm(7,"app-footer"),s.k0s()),2&e&&(s.R7$(),s.Y8G("PageTitle","Map"))},dependencies:[c.W9,c.M0,c.eU,c.oS,v.y,y.C,P,G.e],encapsulation:2}),m})();var T=d(2243),F=d(8132),w=d(7631),x=d(1991);let O=(()=>{var a;class m{}return(a=m).\u0275fac=function(e){return new(e||a)},a.\u0275mod=s.$C({type:a}),a.\u0275inj=M.G2t({imports:[f.MD]}),m})(),b=(()=>{var a;class m{}return(a=m).\u0275fac=function(e){return new(e||a)},a.\u0275mod=s.$C({type:a}),a.\u0275inj=M.G2t({imports:[f.MD,k.YN,c.bv,T.p,w.J,O,x.z,F.iI.forChild([{path:"",component:I}])]}),m})()}}]);